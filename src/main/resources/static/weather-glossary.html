<h1>National Weather Service Glossary</h1>

<div>
    <label for="searchTerm">Search:</label>
    <input type="text" id="searchTerm" />
    <button onclick="getGlossary()">Submit</button>
</div>

<table id="myTable">
    <thead>

        <tr>
            <th onclick="sortTable()">Term</th>
            <th>Definition</th>
        </tr>
    </thead>
    <tbody>
    </tbody>
</table>

<script
        src="https://code.jquery.com/jquery-3.6.0.min.js"
        integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
        crossorigin="anonymous"></script>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>


<script type="text/javascript">

    /**
     * Use axios to query our API for the glossary and then
     * call to render the terms on the response.
     */
    function getGlossary() {

        const searchTerm = $( '#searchTerm' ).val();

        axios
            .get("/api/weather/glossary", { params: { searchTerm } } )
            .then( renderGlossaryResponse );
    }

    /**
     * Use jQuery to render the response into the DOM.
     *
     * @param axios response from our API for the glossary request.
     */
    function renderGlossaryResponse( response ) {
        // TODO: Question: How Would you view the contents of this response in the browser?

        const tableBody = $( 'tbody' );

        tableBody.empty();

        response.data.forEach( term => {
            const termRow = $( '<tr>' );

            termRow.append( $( `<td>${term.term}</td>` ) );
            termRow.append( $( `<td>${term.definition}</td>` ) );

            tableBody.append( termRow );
        });
    }


    function sortTable() {
        const table = document.getElementById("myTable");
        const tbody = table.querySelector("tbody");
        const rows = Array.from(tbody.querySelectorAll("tr"));

        // Determine the current sort direction and toggle it
        const currentDirection = tbody.getAttribute("data-sort-direction") || "asc";
        const newDirection = currentDirection === "asc" ? "desc" : "asc";

        // Sort rows based on the trimmed content of the first column
        rows.sort((rowA, rowB) => {
            const cellA = rowA.children[0].textContent.trim().toLowerCase();
            const cellB = rowB.children[0].textContent.trim().toLowerCase();

            if (cellA < cellB) return newDirection === "asc" ? -1 : 1;
            if (cellA > cellB) return newDirection === "asc" ? 1 : -1;
            return 0;
        });

        // Reorder rows in the table body
        rows.forEach(row => tbody.appendChild(row));

        // Update the sort direction attribute
        tbody.setAttribute("data-sort-direction", newDirection);
    }

    $(document).ready( getGlossary );



</script>

